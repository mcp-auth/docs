---
sidebar_position: 1
sidebar_label: 'νν† λ¦¬μ–Ό: λ‚λ” λ„κµ¬μΈκ°€? (Who am I?)'
---

import TabItem from '@theme/TabItem';
import Tabs from '@theme/Tabs';

import SetupOauth from './_setup-oauth.mdx';
import SetupOidc from './_setup-oidc.mdx';

# νν† λ¦¬μ–Ό: λ‚λ” λ„κµ¬μΈκ°€? (Who am I?)

μ΄ νν† λ¦¬μ–Όμ—μ„λ” MCP Authλ¥Ό μ„¤μ •ν•μ—¬ μ‚¬μ©μλ¥Ό μΈμ¦ (Authentication)ν•κ³  μΈκ°€ (Authorization) μ„λ²„μ—μ„ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό κ°€μ Έμ¤λ” κ³Όμ •μ„ μ•λ‚΄ν•©λ‹λ‹¤.

μ΄ νν† λ¦¬μ–Όμ„ μ™„λ£ν•λ©΄ λ‹¤μμ„ μ–»κ² λ©λ‹λ‹¤:

- β… MCP Authλ¥Ό μ‚¬μ©ν•μ—¬ μ‚¬μ©μλ¥Ό μΈμ¦ (Authentication)ν•λ” λ°©λ²•μ— λ€ν• κΈ°λ³Έμ μΈ μ΄ν•΄
- β… μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό μ΅°νν•  μ μλ” MCP μ„λ²„

## κ°μ” (Overview) \{#overview}

μ΄ νν† λ¦¬μ–Όμ—λ” λ‹¤μκ³Ό κ°™μ€ κµ¬μ„± μ”μ†κ°€ ν¬ν•¨λ©λ‹λ‹¤:

- **MCP μ„λ²„**: MCP κ³µμ‹ SDKλ¥Ό μ‚¬μ©ν•μ—¬ μ”μ²­μ„ μ²λ¦¬ν•λ” κ°„λ‹¨ν• MCP μ„λ²„
- **MCP μΈμ¤ν™ν„°**: MCP μ„λ²„λ¥Ό μ„ν• μ‹κ°μ  ν…μ¤νΈ λ„κµ¬. OAuth / OIDC ν΄λΌμ΄μ–ΈνΈ μ—­ν• λ„ ν•μ—¬ μΈκ°€ (Authorization) ν”λ΅μ°λ¥Ό μ‹μ‘ν•κ³  μ•΅μ„Έμ¤ ν† ν° (Access token)μ„ κ°€μ Έμµλ‹λ‹¤.
- **μΈκ°€ (Authorization) μ„λ²„**: μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹°λ¥Ό κ΄€λ¦¬ν•κ³  μ•΅μ„Έμ¤ ν† ν° (Access token)μ„ λ°κΈ‰ν•λ” OAuth 2.1 λλ” OpenID Connect μ κ³µμ

μ•„λλ” μ΄ κµ¬μ„± μ”μ†λ“¤ κ°„μ μƒνΈμ‘μ©μ„ λ‚νƒ€λ‚Έ κ³ μμ¤€ λ‹¤μ΄μ–΄κ·Έλ¨μ…λ‹λ‹¤:

```mermaid
sequenceDiagram
    participant Client as MCP μΈμ¤ν™ν„°
    participant Server as MCP μ„λ²„
    participant Auth as μΈκ°€ (Authorization) μ„λ²„

    Client->>Server: `whoami` λ„κµ¬ μ”μ²­
    Server->>Client: 401 μΈκ°€λμ§€ μ•μ λ°ν™
    Client->>Auth: μΈκ°€ (Authorization) ν”λ΅μ° μ‹μ‘
    Auth->>Auth: μΈκ°€ (Authorization) ν”λ΅μ° μ™„λ£
    Auth->>Client: μΈκ°€ μ½”λ“μ™€ ν•¨κ» λ¦¬λ””λ ‰μ…
    Client->>Auth: μ½”λ“λ΅ μ•΅μ„Έμ¤ ν† ν° (Access token) κµν™
    Auth->>Client: μ•΅μ„Έμ¤ ν† ν° (Access token) λ°ν™
    Client->>Server: μ•΅μ„Έμ¤ ν† ν° (Access token)μΌλ΅ `whoami` μ”μ²­
    Server->>Auth: μ•΅μ„Έμ¤ ν† ν° (Access token)μΌλ΅ μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ΅°ν
    Auth->>Server: μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° λ°ν™
    Server->>Client: μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° λ°ν™
```

## μΈκ°€ (Authorization) μ„λ²„ μ΄ν•΄ν•κΈ° \{#understand-your-authorization-server}

### μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄ μ΅°νν•κΈ° \{#retrieving-user-identity-information}

μ΄ νν† λ¦¬μ–Όμ„ μ™„λ£ν•λ ¤λ©΄, μΈκ°€ (Authorization) μ„λ²„κ°€ μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό μ΅°νν•  μ μλ” APIλ¥Ό μ κ³µν•΄μ•Ό ν•©λ‹λ‹¤:

<Tabs groupId="provider">
<TabItem value="logto" label="Logto">

[Logto](https://logto.io)λ” ν‘μ¤€ [userinfo μ—”λ“ν¬μΈνΈ](https://openid.net/specs/openid-connect-core-1_0.html#UserInfo)λ¥Ό μ§€μ›ν•λ” OpenID Connect μ κ³µμμ…λ‹λ‹¤.

userinfo μ—”λ“ν¬μΈνΈμ— μ ‘κ·Όν•  μ μλ” μ•΅μ„Έμ¤ ν† ν° (Access token)μ„ μ–»μΌλ ¤λ©΄ μµμ† λ‘ κ°μ μ¤μ½”ν”„ (Scope), μ¦‰ `openid`μ™€ `profile`μ΄ ν•„μ”ν•©λ‹λ‹¤. μ¤μ½”ν”„ μ„¤μ •μ€ μ•„λμ—μ„ λ‹¤λ£¨λ‹ κ³„μ† μ½μ–΄μ£Όμ„Έμ”.

</TabItem>
<TabItem value="keycloak" label="Keycloak">

[Keycloak](https://www.keycloak.org)μ€ OpenID Connect (OIDC)λ¥Ό ν¬ν•¨ν• μ—¬λ¬ ν”„λ΅ν† μ½μ„ μ§€μ›ν•λ” μ¤ν”μ†μ¤ μ•„μ΄λ΄ν‹°ν‹° λ° μ ‘κ·Ό κ΄€λ¦¬ μ†”λ£¨μ…μ…λ‹λ‹¤. OIDC μ κ³µμλ΅μ„ ν‘μ¤€ [userinfo μ—”λ“ν¬μΈνΈ](https://openid.net/specs/openid-connect-core-1_0.html#UserInfo)λ¥Ό κµ¬ν„ν•μ—¬ μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό μ΅°νν•  μ μμµλ‹λ‹¤.

userinfo μ—”λ“ν¬μΈνΈμ— μ ‘κ·Όν•  μ μλ” μ•΅μ„Έμ¤ ν† ν° (Access token)μ„ μ–»μΌλ ¤λ©΄ μµμ† λ‘ κ°μ μ¤μ½”ν”„ (Scope), μ¦‰ `openid`μ™€ `profile`μ΄ ν•„μ”ν•©λ‹λ‹¤. μ¤μ½”ν”„ μ„¤μ •μ€ μ•„λμ—μ„ λ‹¤λ£¨λ‹ κ³„μ† μ½μ–΄μ£Όμ„Έμ”.

</TabItem>
<TabItem value="oidc" label="OIDC">

λ€λ¶€λ¶„μ OpenID Connect μ κ³µμλ” [userinfo μ—”λ“ν¬μΈνΈ](https://openid.net/specs/openid-connect-core-1_0.html#UserInfo)λ¥Ό μ§€μ›ν•μ—¬ μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό μ΅°νν•  μ μμµλ‹λ‹¤.

μ κ³µμμ λ¬Έμ„λ¥Ό ν™•μΈν•μ—¬ μ΄ μ—”λ“ν¬μΈνΈλ¥Ό μ§€μ›ν•λ”μ§€ ν™•μΈν•μ„Έμ”. μ κ³µμκ°€ [OpenID Connect Discovery](https://openid.net/specs/openid-connect-discovery-1_0.html)λ¥Ό μ§€μ›ν•λ‹¤λ©΄, `.well-known/openid-configuration` μ—”λ“ν¬μΈνΈμ μ‘λ‹µμ—μ„ `userinfo_endpoint`κ°€ ν¬ν•¨λμ–΄ μλ”μ§€ ν™•μΈν•  μ μμµλ‹λ‹¤.

userinfo μ—”λ“ν¬μΈνΈμ— μ ‘κ·Όν•  μ μλ” μ•΅μ„Έμ¤ ν† ν° (Access token)μ„ μ–»μΌλ ¤λ©΄ μµμ† λ‘ κ°μ μ¤μ½”ν”„ (Scope), μ¦‰ `openid`μ™€ `profile`μ΄ ν•„μ”ν•©λ‹λ‹¤. μ¤μ½”ν”„μ™€ μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° ν΄λ μ„ (Claim) λ§¤ν•‘μ€ μ κ³µμ λ¬Έμ„λ¥Ό μ°Έκ³ ν•μ„Έμ”.

</TabItem>
<TabItem value="oauth" label="OAuth 2">

OAuth 2.0μ€ μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό μ΅°νν•λ” ν‘μ¤€ λ°©λ²•μ„ μ •μν•μ§€ μ•μ§€λ§, λ§μ€ μ κ³µμκ°€ μμ²΄ μ—”λ“ν¬μΈνΈλ¥Ό κµ¬ν„ν•©λ‹λ‹¤. μ•΅μ„Έμ¤ ν† ν° (Access token)μΌλ΅ μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό μ–΄λ–»κ² μ΅°νν•λ”μ§€, μΈκ°€ (Authorization) ν”λ΅μ°μ—μ„ μ–΄λ–¤ νλΌλ―Έν„°κ°€ ν•„μ”ν•μ§€ μ κ³µμ λ¬Έμ„λ¥Ό ν™•μΈν•μ„Έμ”.

</TabItem>
</Tabs>

### λ™μ  ν΄λΌμ΄μ–ΈνΈ λ“±λ΅ (Dynamic Client Registration) \{#dynamic-client-registration}

μ΄ νν† λ¦¬μ–Όμ—μ„λ” λ™μ  ν΄λΌμ΄μ–ΈνΈ λ“±λ΅μ΄ ν•„μλ” μ•„λ‹μ§€λ§, MCP ν΄λΌμ΄μ–ΈνΈ λ“±λ΅ κ³Όμ •μ„ μλ™ν™”ν•κ³  μ‹¶λ‹¤λ©΄ μ μ©ν•  μ μμµλ‹λ‹¤. μμ„Έν• λ‚΄μ©μ€ [λ™μ  ν΄λΌμ΄μ–ΈνΈ λ“±λ΅μ΄ ν•„μ”ν•κ°€μ”?](../../provider-list.mdx#is-dcr-required) λ¥Ό μ°Έκ³ ν•μ„Έμ”.

## MCP μ„λ²„ μ„¤μ •ν•κΈ° \{#set-up-the-mcp-server}

[MCP κ³µμ‹ SDK](https://github.com/modelcontextprotocol)λ¥Ό μ‚¬μ©ν•μ—¬ μΈκ°€ (Authorization) μ„λ²„μ—μ„ μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό μ΅°νν•λ” `whoami` λ„κµ¬κ°€ ν¬ν•¨λ MCP μ„λ²„λ¥Ό λ§λ“­λ‹λ‹¤.

### μƒ ν”„λ΅μ νΈ μƒμ„±ν•κΈ° \{#create-a-new-project}

<Tabs groupId="sdk">
<TabItem value="python" label="Python">

```bash
mkdir mcp-server
cd mcp-server
uv init # λλ” `pipenv`λ‚ `poetry`λ΅ μƒ κ°€μƒν™κ²½ μƒμ„±
```

</TabItem>
<TabItem value="node" label="Node.js">

μƒ Node.js ν”„λ΅μ νΈλ¥Ό μ„¤μ •ν•μ„Έμ”:

```bash
mkdir mcp-server
cd mcp-server
npm init -y # λλ” `pnpm init`
npm pkg set type="module"
npm pkg set main="whoami.js"
npm pkg set scripts.start="node whoami.js"
```

</TabItem>
</Tabs>

### MCP SDK λ° μμ΅΄μ„± μ„¤μΉν•κΈ° \{#install-the-mcp-sdk-and-dependencies}

<Tabs groupId="sdk">
<TabItem value="python" label="Python">

```bash
pip install "mcp[cli]" starlette uvicorn
```

λλ” `uv`, `poetry` λ“± μ›ν•λ” ν¨ν‚¤μ§€ λ§¤λ‹μ €λ¥Ό μ‚¬μ©ν•μ„Έμ”.

</TabItem>
<TabItem value="node" label="Node.js">

```bash
npm install @modelcontextprotocol/sdk express
```

λλ” `pnpm`, `yarn` λ“± μ›ν•λ” ν¨ν‚¤μ§€ λ§¤λ‹μ €λ¥Ό μ‚¬μ©ν•μ„Έμ”.

</TabItem>
</Tabs>

### MCP μ„λ²„ λ§λ“¤κΈ° \{#create-the-mcp-server}

λ¨Όμ €, `whoami` λ„κµ¬λ¥Ό κµ¬ν„ν•λ” MCP μ„λ²„λ¥Ό λ§λ“­λ‹λ‹¤.

<Tabs groupId="sdk">
<TabItem value="python" label="Python">

`whoami.py`λΌλ” νμΌμ„ λ§λ“¤κ³  λ‹¤μ μ½”λ“λ¥Ό μ¶”κ°€ν•μ„Έμ”:

```python
from mcp.server.fastmcp import FastMCP
from starlette.applications import Starlette
from starlette.routing import Mount
from typing import Any

mcp = FastMCP("WhoAmI")

@mcp.tool()
def whoami() -> dict[str, Any]:
    """ν„μ¬ μ‚¬μ©μμ μ •λ³΄λ¥Ό λ°ν™ν•λ” λ„κµ¬μ…λ‹λ‹¤."""
    return {"error": "Not authenticated"}

app = Starlette(
    routes=[Mount('/', app=mcp.sse_app())]
)
```

μ„λ²„ μ‹¤ν–‰:

```bash
uvicorn whoami:app --host 0.0.0.0 --port 3001
```

</TabItem>
<TabItem value="node" label="Node.js">

:::note
ν„μ¬ MCP μΈμ¤ν™ν„° κµ¬ν„μ€ μΈκ°€ (Authorization) ν”λ΅μ°λ¥Ό μ²λ¦¬ν•μ§€ μ•μΌλ―€λ΅, SSE λ°©μ‹μ„ μ‚¬μ©ν•΄ MCP μ„λ²„λ¥Ό μ„¤μ •ν•©λ‹λ‹¤. MCP μΈμ¤ν™ν„°κ°€ μΈκ°€ (Authorization) ν”λ΅μ°λ¥Ό μ§€μ›ν•λ©΄ μ½”λ“λ¥Ό μ—…λ°μ΄νΈν•κ² μµλ‹λ‹¤.
:::

`pnpm`μ΄λ‚ `yarn`λ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

`whoami.js`λΌλ” νμΌμ„ λ§λ“¤κ³  λ‹¤μ μ½”λ“λ¥Ό μ¶”κ°€ν•μ„Έμ”:

```js
import { McpServer } from '@modelcontextprotocol/sdk/server/mcp.js';
import { SSEServerTransport } from '@modelcontextprotocol/sdk/server/sse.js';
import express from 'express';

// MCP μ„λ²„ μƒμ„±
const server = new McpServer({
  name: 'WhoAmI',
  version: '0.0.0',
});

// ν„μ¬ μ‚¬μ©μμ μ •λ³΄λ¥Ό λ°ν™ν•λ” λ„κµ¬ μ¶”κ°€
server.tool('whoami', async () => {
  return {
    content: [{ type: 'text', text: JSON.stringify({ error: 'Not authenticated' }) }],
  };
});

// μ•„λλ” MCP SDK λ¬Έμ„μ λ³΄μΌλ¬ν”λ μ΄νΈ μ½”λ“μ…λ‹λ‹¤
const PORT = 3001;
const app = express();

const transports = {};

app.get('/sse', async (_req, res) => {
  const transport = new SSEServerTransport('/messages', res);
  transports[transport.sessionId] = transport;

  res.on('close', () => {
    delete transports[transport.sessionId];
  });

  await server.connect(transport);
});

app.post('/messages', async (req, res) => {
  const sessionId = String(req.query.sessionId);
  const transport = transports[sessionId];
  if (transport) {
    await transport.handlePostMessage(req, res, req.body);
  } else {
    res.status(400).send('No transport found for sessionId');
  }
});

app.listen(PORT);
```

μ„λ²„ μ‹¤ν–‰:

```bash
npm start
```

</TabItem>
</Tabs>

## MCP μ„λ²„ μ κ²€ν•κΈ° \{#inspect-the-mcp-server}

### MCP μΈμ¤ν™ν„° ν΄λ΅  λ° μ‹¤ν–‰ \{#clone-and-run-mcp-inspector}

μ΄μ  MCP μ„λ²„κ°€ μ‹¤ν–‰ μ¤‘μ΄λ―€λ΅, MCP μΈμ¤ν™ν„°λ¥Ό μ‚¬μ©ν•΄ `whoami` λ„κµ¬κ°€ μ‚¬μ© κ°€λ¥ν•μ§€ ν™•μΈν•  μ μμµλ‹λ‹¤.

ν„μ¬ κµ¬ν„μ ν•κ³„λ΅ μΈν•΄, [MCP μΈμ¤ν™ν„°](https://github.com/mcp-auth/inspector)λ¥Ό ν¬ν¬ν•μ—¬ μΈμ¦ (Authentication) λ° μΈκ°€ (Authorization)μ— λ” μ μ—°ν•κ³  ν™•μ¥ κ°€λ¥ν•λ„λ΅ κ°μ„ ν–μµλ‹λ‹¤. λ³€κ²½ μ‚¬ν•­μ„ μ›λ³Έ μ €μ¥μ†μ— PRλ΅ μ μ¶ν–μµλ‹λ‹¤.

MCP μΈμ¤ν™ν„°λ¥Ό μ‹¤ν–‰ν•λ ¤λ©΄ (Node.js ν•„μ”):

```bash
git clone https://github.com/mcp-auth/inspector.git
cd inspector
npm install
npm run dev
```

κ·Έλ° λ‹¤μ λΈλΌμ°μ €μ—μ„ `http://localhost:6274/` (λλ” ν„°λ―Έλ„μ— ν‘μ‹λ URL)λ΅ μ ‘μ†ν•μ—¬ MCP μΈμ¤ν™ν„°μ— μ ‘κ·Όν•μ„Έμ”.

### MCP μΈμ¤ν™ν„°λ¥Ό MCP μ„λ²„μ— μ—°κ²°ν•κΈ° \{#connect-mcp-inspector-to-the-mcp-server}

μ§„ν–‰ν•κΈ° μ „μ— MCP μΈμ¤ν™ν„°μ—μ„ λ‹¤μ μ„¤μ •μ„ ν™•μΈν•μ„Έμ”:

- **Transport Type**: `SSE`λ΅ μ„¤μ •
- **URL**: MCP μ„λ²„μ URLλ΅ μ„¤μ • (μ: `http://localhost:3001/sse`)

μ΄μ  "Connect" λ²„νΌμ„ ν΄λ¦­ν•μ—¬ MCP μΈμ¤ν™ν„°κ°€ MCP μ„λ²„μ— μ—°κ²°λλ”μ§€ ν™•μΈν•μ„Έμ”. μ •μƒμ μΌλ΅ μ—°κ²°λλ©΄ MCP μΈμ¤ν™ν„°μ—μ„ "Connected" μƒνƒλ¥Ό λ³Ό μ μμµλ‹λ‹¤.

### μ²΄ν¬ν¬μΈνΈ: `whoami` λ„κµ¬ μ‹¤ν–‰ν•κΈ° \{#checkpoint-run-the-whoami-tool}

1. MCP μΈμ¤ν™ν„° μƒλ‹¨ λ©”λ‰΄μ—μ„ "Tools" νƒ­ ν΄λ¦­
2. "List Tools" λ²„νΌ ν΄λ¦­
3. νμ΄μ§€μ— `whoami` λ„κµ¬κ°€ ν‘μ‹λμ–΄μ•Ό ν•©λ‹λ‹¤. ν΄λ¦­ν•μ—¬ λ„κµ¬ μƒμ„Έ λ³΄κΈ°
4. μ°μΈ΅μ— "Run Tool" λ²„νΌμ΄ λ³΄μ…λ‹λ‹¤. ν΄λ¦­ν•μ—¬ λ„κµ¬ μ‹¤ν–‰
5. JSON μ‘λ‹µ `{"error": "Not authenticated"}`κ°€ κ²°κ³Όλ΅ ν‘μ‹λμ–΄μ•Ό ν•©λ‹λ‹¤.

![MCP μΈμ¤ν™ν„° μ²« μ‹¤ν–‰](/docs-assets/images/tutorials/whoami/inspector-first-run.png)

## μΈκ°€ (Authorization) μ„λ²„μ™€ ν†µν•©ν•κΈ° \{#integrate-with-your-authorization-server}

μ΄ μ„Ήμ…μ„ μ™„λ£ν•λ ¤λ©΄ λ‹¤μ μ‚¬ν•­λ“¤μ„ κ³ λ ¤ν•΄μ•Ό ν•©λ‹λ‹¤:

<details>
<summary>**μΈκ°€ (Authorization) μ„λ²„μ λ°κΈ‰μ (Issuer) URL**</summary>

μΌλ°μ μΌλ΅ μΈκ°€ (Authorization) μ„λ²„μ κΈ°λ³Έ URLμ…λ‹λ‹¤. μ: `https://auth.example.com`. μΌλ¶€ μ κ³µμλ” `https://example.logto.app/oidc`μ™€ κ°™μ΄ κ²½λ΅κ°€ ν¬ν•¨λ  μ μμΌλ‹, μ κ³µμ λ¬Έμ„λ¥Ό κΌ­ ν™•μΈν•μ„Έμ”.

</details>

<details>
<summary>**μΈκ°€ (Authorization) μ„λ²„ λ©”νƒ€λ°μ΄ν„° μ΅°ν λ°©λ²•**</summary>

- μΈκ°€ (Authorization) μ„λ²„κ°€ [OAuth 2.0 Authorization Server Metadata](https://datatracker.ietf.org/doc/html/rfc8414) λλ” [OpenID Connect Discovery](https://openid.net/specs/openid-connect-discovery-1_0.html)λ¥Ό μ¤€μν•λ‹¤λ©΄, MCP Auth λ‚΄μ¥ μ ν‹Έλ¦¬ν‹°λ΅ λ©”νƒ€λ°μ΄ν„°λ¥Ό μλ™μΌλ΅ κ°€μ Έμ¬ μ μμµλ‹λ‹¤.
- μ¤€μν•μ§€ μ•λ” κ²½μ°, MCP μ„λ²„ μ„¤μ •μ—μ„ λ©”νƒ€λ°μ΄ν„° URL λλ” μ—”λ“ν¬μΈνΈλ¥Ό μλ™μΌλ΅ μ§€μ •ν•΄μ•Ό ν•©λ‹λ‹¤. μ κ³µμ λ¬Έμ„μ—μ„ μ—”λ“ν¬μΈνΈλ¥Ό ν™•μΈν•μ„Έμ”.

</details>

<details>
<summary>**MCP μΈμ¤ν™ν„°λ¥Ό μΈκ°€ (Authorization) μ„λ²„μ— ν΄λΌμ΄μ–ΈνΈλ΅ λ“±λ΅ν•λ” λ°©λ²•**</summary>

- μΈκ°€ (Authorization) μ„λ²„κ°€ [λ™μ  ν΄λΌμ΄μ–ΈνΈ λ“±λ΅](https://datatracker.ietf.org/doc/html/rfc7591)μ„ μ§€μ›ν•λ‹¤λ©΄, MCP μΈμ¤ν™ν„°κ°€ μλ™μΌλ΅ ν΄λΌμ΄μ–ΈνΈλ΅ λ“±λ΅λλ―€λ΅ μ΄ λ‹¨κ³„λ¥Ό κ±΄λ„λ›Έ μ μμµλ‹λ‹¤.
- μ§€μ›ν•μ§€ μ•λ” κ²½μ°, MCP μΈμ¤ν™ν„°λ¥Ό μΈκ°€ (Authorization) μ„λ²„μ— μλ™μΌλ΅ ν΄λΌμ΄μ–ΈνΈλ΅ λ“±λ΅ν•΄μ•Ό ν•©λ‹λ‹¤.

</details>

<details>
<summary>**μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄ μ΅°ν λ° μΈκ°€ (Authorization) μ”μ²­ νλΌλ―Έν„° μ„¤μ • λ°©λ²•**</summary>

- OpenID Connect μ κ³µμμ κ²½μ°: μΈκ°€ (Authorization) ν”λ΅μ° μ‹μ‘ μ‹ μµμ† `openid`μ™€ `profile` μ¤μ½”ν”„ (Scope)λ¥Ό μ”μ²­ν•΄μ•Ό ν•©λ‹λ‹¤. μ΄λ ‡κ² ν•λ©΄ μΈκ°€ (Authorization) μ„λ²„κ°€ λ°ν™ν•λ” μ•΅μ„Έμ¤ ν† ν° (Access token)μ— [userinfo μ—”λ“ν¬μΈνΈ](https://openid.net/specs/openid-connect-core-1_0.html#UserInfo)μ— μ ‘κ·Όν•  μ μλ” κ¶ν•μ΄ ν¬ν•¨λ©λ‹λ‹¤.

  μ°Έκ³ : μΌλ¶€ μ κ³µμλ” userinfo μ—”λ“ν¬μΈνΈλ¥Ό μ§€μ›ν•μ§€ μ•μ„ μ μμµλ‹λ‹¤.

- OAuth 2.0 / OAuth 2.1 μ κ³µμμ κ²½μ°: μ•΅μ„Έμ¤ ν† ν° (Access token)μΌλ΅ μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό μ–΄λ–»κ² μ΅°νν•λ”μ§€, μ–΄λ–¤ νλΌλ―Έν„°κ°€ ν•„μ”ν•μ§€ μ κ³µμ λ¬Έμ„λ¥Ό ν™•μΈν•μ„Έμ”.

</details>

κ° μ κ³µμλ§λ‹¤ μ„Έλ¶€ μ”κµ¬μ‚¬ν•­μ΄ λ‹¤λ¥Ό μ μμ§€λ§, μ•„λ λ‹¨κ³„μ— λ”°λΌ MCP μΈμ¤ν™ν„°μ™€ MCP μ„λ²„λ¥Ό μ κ³µμλ³„ μ„¤μ •μΌλ΅ ν†µν•©ν•  μ μμµλ‹λ‹¤.

### MCP μΈμ¤ν™ν„°λ¥Ό ν΄λΌμ΄μ–ΈνΈλ΅ λ“±λ΅ν•κΈ° \{#register-mcp-inspector-as-a-client}

<Tabs groupId="provider">
<TabItem value="logto" label="Logto">

[Logto](https://logto.io)λ” ν‘μ¤€ [userinfo μ—”λ“ν¬μΈνΈ](https://openid.net/specs/openid-connect-core-1_0.html#UserInfo)λ¥Ό μ§€μ›ν•λ” OpenID Connect μ κ³µμμ΄λ―€λ΅ ν†µν•©μ΄ κ°„λ‹¨ν•©λ‹λ‹¤.

Logtoλ” μ•„μ§ λ™μ  ν΄λΌμ΄μ–ΈνΈ λ“±λ΅μ„ μ§€μ›ν•μ§€ μ•μΌλ―€λ΅, MCP μΈμ¤ν™ν„°λ¥Ό Logto ν…λ„νΈμ— μλ™μΌλ΅ ν΄λΌμ΄μ–ΈνΈλ΅ λ“±λ΅ν•΄μ•Ό ν•©λ‹λ‹¤:

1. MCP μΈμ¤ν™ν„°μ—μ„ "OAuth Configuration" λ²„νΌμ„ ν΄λ¦­ν•κ³  **Redirect URL (μλ™ μ…λ ¥)** κ°’μ„ λ³µμ‚¬ν•μ„Έμ”. μ: `http://localhost:6274/oauth/callback`
2. [Logto Console](https://cloud.logto.io) (λλ” μμ²΄ νΈμ¤ν… Logto Console)μ— λ΅κ·ΈμΈν•μ„Έμ”.
3. "Applications" νƒ­μ—μ„ "Create application" ν΄λ¦­. νμ΄μ§€ ν•λ‹¨μ—μ„ "Create app without framework" ν΄λ¦­.
4. μ• ν”λ¦¬μΌ€μ΄μ… μ •λ³΄λ¥Ό μ…λ ¥ν•κ³  "Create application" ν΄λ¦­:
   - **Select an application type**: "Single-page application" μ„ νƒ
   - **Application name**: μ: "MCP Inspector"
5. "Settings / Redirect URIs" μ„Ήμ…μ— λ³µμ‚¬ν• **Redirect URL (μλ™ μ…λ ¥)** κ°’μ„ λ¶™μ—¬λ„£κ³ , ν•λ‹¨ λ°”μ—μ„ "Save changes" ν΄λ¦­
6. μƒλ‹¨ μΉ΄λ“μ—μ„ "App ID" κ°’μ„ λ³µμ‚¬ν•μ„Έμ”.
7. MCP μΈμ¤ν™ν„°λ΅ λμ•„κ°€ "OAuth Configuration"μ "Client ID"μ— "App ID" κ°’μ„ λ¶™μ—¬λ„£μΌμ„Έμ”.
8. "Auth Params" ν•„λ“μ— `{"scope": "openid profile email"}` κ°’μ„ μ…λ ¥ν•μ„Έμ”. μ΄λ ‡κ² ν•λ©΄ Logtoκ°€ λ°ν™ν•λ” μ•΅μ„Έμ¤ ν† ν° (Access token)μ— userinfo μ—”λ“ν¬μΈνΈ μ ‘κ·Όμ— ν•„μ”ν• μ¤μ½”ν”„κ°€ ν¬ν•¨λ©λ‹λ‹¤.

</TabItem>
<TabItem value="keycloak" label="Keycloak">

[Keycloak](https://www.keycloak.org)μ€ OpenID Connect ν”„λ΅ν† μ½μ„ μ§€μ›ν•λ” μ¤ν”μ†μ¤ μ•„μ΄λ΄ν‹°ν‹° λ° μ ‘κ·Ό κ΄€λ¦¬ μ†”λ£¨μ…μ…λ‹λ‹¤.

Keycloakμ€ λ™μ  ν΄λΌμ΄μ–ΈνΈ λ“±λ΅μ„ μ§€μ›ν•μ§€λ§, ν΄λΌμ΄μ–ΈνΈ λ“±λ΅ μ—”λ“ν¬μΈνΈκ°€ CORSλ¥Ό μ§€μ›ν•μ§€ μ•μ•„ λ€λ¶€λ¶„μ MCP ν΄λΌμ΄μ–ΈνΈκ°€ μ§μ ‘ λ“±λ΅ν•  μ μ—†μµλ‹λ‹¤. λ”°λΌμ„ μλ™μΌλ΅ ν΄λΌμ΄μ–ΈνΈλ¥Ό λ“±λ΅ν•΄μ•Ό ν•©λ‹λ‹¤.

:::note
Keycloakμ€ [μ—¬λ¬ λ°©μ‹](https://www.keycloak.org/guides#getting-started) (λ² μ–΄λ©”νƒ, μΏ λ²„λ„¤ν‹°μ¤ λ“±)μΌλ΅ μ„¤μΉν•  μ μμ§€λ§, μ΄ νν† λ¦¬μ–Όμ—μ„λ” Dockerλ΅ λΉ λ¥΄κ² μ„¤μ •ν•©λ‹λ‹¤.
:::

Keycloak μΈμ¤ν„΄μ¤λ¥Ό μ„¤μ •ν•κ³  κµ¬μ„±ν•΄λ΄…μ‹λ‹¤:

1. [κ³µμ‹ λ¬Έμ„](https://www.keycloak.org/getting-started/getting-started-docker)λ¥Ό μ°Έκ³ ν•μ—¬ Dockerλ΅ Keycloak μΈμ¤ν„΄μ¤ μ‹¤ν–‰:

```bash
docker run -p 8080:8080 -e KC_BOOTSTRAP_ADMIN_USERNAME=admin -e KC_BOOTSTRAP_ADMIN_PASSWORD=admin quay.io/keycloak/keycloak:26.2.4 start-dev
```

2. Keycloak Admin Console (http://localhost:8080/admin)μ— μ ‘μ†ν•μ—¬ μ•„λ κ³„μ •μΌλ΅ λ΅κ·ΈμΈ:

   - Username: `admin`
   - Password: `admin`

3. μƒ Realm μƒμ„±:

   - μΆμΈ΅ μƒλ‹¨ "Create Realm" ν΄λ¦­
   - "Realm name"μ— `mcp-realm` μ…λ ¥
   - "Create" ν΄λ¦­

4. ν…μ¤νΈ μ‚¬μ©μ μƒμ„±:

   - μΆμΈ΅ λ©”λ‰΄ "Users" ν΄λ¦­
   - "Create new user" ν΄λ¦­
   - μ‚¬μ©μ μ •λ³΄ μ…λ ¥:
     - Username: `testuser`
     - First name, Last nameμ€ μ„μ κ°’
   - "Create" ν΄λ¦­
   - "Credentials" νƒ­μ—μ„ λΉ„λ°€λ²νΈ μ„¤μ •, "Temporary" ν•΄μ 

5. MCP μΈμ¤ν™ν„°λ¥Ό ν΄λΌμ΄μ–ΈνΈλ΅ λ“±λ΅:

   - MCP μΈμ¤ν™ν„°μ—μ„ "OAuth Configuration" λ²„νΌ ν΄λ¦­, **Redirect URL (μλ™ μ…λ ¥)** κ°’ λ³µμ‚¬ (μ: `http://localhost:6274/oauth/callback`)
   - Keycloak Admin Consoleμ—μ„ μΆμΈ΅ "Clients" ν΄λ¦­
   - "Create client" ν΄λ¦­
   - ν΄λΌμ΄μ–ΈνΈ μ •λ³΄ μ…λ ¥:
     - Client type: "OpenID Connect" μ„ νƒ
     - Client ID: `mcp-inspector` μ…λ ¥
     - "Next" ν΄λ¦­
   - "Capability config" νμ΄μ§€:
     - "Standard flow" ν™μ„±ν™” ν™•μΈ
     - "Next" ν΄λ¦­
   - "Login settings" νμ΄μ§€:
     - "Valid redirect URIs"μ— MCP μΈμ¤ν™ν„° μ½λ°± URL λ¶™μ—¬λ„£κΈ°
     - "Web origins"μ— `http://localhost:6274` μ…λ ¥
     - "Save" ν΄λ¦­
   - "Client ID" (`mcp-inspector`) λ³µμ‚¬

6. MCP μΈμ¤ν™ν„°λ΅ λμ•„κ°€μ„:
   - "OAuth Configuration"μ "Client ID" ν•„λ“μ— λ³µμ‚¬ν• Client ID λ¶™μ—¬λ„£κΈ°
   - "Auth Params" ν•„λ“μ— μ•„λ κ°’ μ…λ ¥:

```json
{ "scope": "openid profile email" }
```

</TabItem>
<TabItem value="oidc" label="OIDC">

:::note
μ΄ κ°€μ΄λ“λ” μΌλ°μ μΈ OpenID Connect μ κ³µμ ν†µν•© μ•λ‚΄μ…λ‹λ‹¤. μ„Έλ¶€ μ‚¬ν•­μ€ μ κ³µμ λ¬Έμ„λ¥Ό μ°Έκ³ ν•μ„Έμ”.
:::

OpenID Connect μ κ³µμκ°€ λ™μ  ν΄λΌμ΄μ–ΈνΈ λ“±λ΅μ„ μ§€μ›ν•λ‹¤λ©΄ μ•„λ 8λ² λ‹¨κ³„λ΅ λ°”λ΅ μ΄λ™ν•μ—¬ MCP μΈμ¤ν™ν„°λ¥Ό μ„¤μ •ν•μ„Έμ”. κ·Έλ ‡μ§€ μ•μΌλ©΄ MCP μΈμ¤ν™ν„°λ¥Ό μλ™μΌλ΅ ν΄λΌμ΄μ–ΈνΈλ΅ λ“±λ΅ν•΄μ•Ό ν•©λ‹λ‹¤:

1. MCP μΈμ¤ν™ν„°μ—μ„ "OAuth Configuration" λ²„νΌ ν΄λ¦­, **Redirect URL (μλ™ μ…λ ¥)** κ°’ λ³µμ‚¬ (μ: `http://localhost:6274/oauth/callback`)
2. OpenID Connect μ κ³µμ μ½μ†”μ— λ΅κ·ΈμΈ
3. "Applications" λλ” "Clients" μ„Ήμ…μ—μ„ μƒ μ• ν”λ¦¬μΌ€μ΄μ…/ν΄λΌμ΄μ–ΈνΈ μƒμ„±
4. ν΄λΌμ΄μ–ΈνΈ νƒ€μ…μ΄ ν•„μ”ν•λ‹¤λ©΄ "Single-page application" λλ” "Public client" μ„ νƒ
5. μ• ν”λ¦¬μΌ€μ΄μ… μƒμ„± ν›„, λ¦¬λ””λ ‰μ… URIμ— MCP μΈμ¤ν™ν„°μ **Redirect URL (μλ™ μ…λ ¥)** κ°’ λ¶™μ—¬λ„£κΈ°
6. μƒλ΅ μƒμ„±λ μ• ν”λ¦¬μΌ€μ΄μ…μ "Client ID" λλ” "Application ID" λ³µμ‚¬
7. MCP μΈμ¤ν™ν„°λ΅ λμ•„κ°€ "OAuth Configuration"μ "Client ID"μ— λ¶™μ—¬λ„£κΈ°
8. ν‘μ¤€ OpenID Connect μ κ³µμμ κ²½μ°, userinfo μ—”λ“ν¬μΈνΈ μ ‘κ·Όμ— ν•„μ”ν• μ¤μ½”ν”„λ¥Ό μ”μ²­ν•λ ¤λ©΄ "Auth Params" ν•„λ“μ— μ•„λ κ°’ μ…λ ¥:

```json
{ "scope": "openid profile email" }
```

</TabItem>
<TabItem value="oauth" label="OAuth 2">

:::note
μ΄ κ°€μ΄λ“λ” μΌλ°μ μΈ OAuth 2.0 / OAuth 2.1 μ κ³µμ ν†µν•© μ•λ‚΄μ…λ‹λ‹¤. μ„Έλ¶€ μ‚¬ν•­μ€ μ κ³µμ λ¬Έμ„λ¥Ό μ°Έκ³ ν•μ„Έμ”.
:::

OAuth 2.0 / OAuth 2.1 μ κ³µμκ°€ λ™μ  ν΄λΌμ΄μ–ΈνΈ λ“±λ΅μ„ μ§€μ›ν•λ‹¤λ©΄ μ•„λ 8λ² λ‹¨κ³„λ΅ λ°”λ΅ μ΄λ™ν•μ—¬ MCP μΈμ¤ν™ν„°λ¥Ό μ„¤μ •ν•μ„Έμ”. κ·Έλ ‡μ§€ μ•μΌλ©΄ MCP μΈμ¤ν™ν„°λ¥Ό μλ™μΌλ΅ ν΄λΌμ΄μ–ΈνΈλ΅ λ“±λ΅ν•΄μ•Ό ν•©λ‹λ‹¤:

1. MCP μΈμ¤ν™ν„°μ—μ„ "OAuth Configuration" λ²„νΌ ν΄λ¦­, **Redirect URL (μλ™ μ…λ ¥)** κ°’ λ³µμ‚¬ (μ: `http://localhost:6274/oauth/callback`)
2. OAuth 2.0 / OAuth 2.1 μ κ³µμ μ½μ†”μ— λ΅κ·ΈμΈ
3. "Applications" λλ” "Clients" μ„Ήμ…μ—μ„ μƒ μ• ν”λ¦¬μΌ€μ΄μ…/ν΄λΌμ΄μ–ΈνΈ μƒμ„±
4. ν΄λΌμ΄μ–ΈνΈ νƒ€μ…μ΄ ν•„μ”ν•λ‹¤λ©΄ "Single-page application" λλ” "Public client" μ„ νƒ
5. μ• ν”λ¦¬μΌ€μ΄μ… μƒμ„± ν›„, λ¦¬λ””λ ‰μ… URIμ— MCP μΈμ¤ν™ν„°μ **Redirect URL (μλ™ μ…λ ¥)** κ°’ λ¶™μ—¬λ„£κΈ°
6. μƒλ΅ μƒμ„±λ μ• ν”λ¦¬μΌ€μ΄μ…μ "Client ID" λλ” "Application ID" λ³µμ‚¬
7. MCP μΈμ¤ν™ν„°λ΅ λμ•„κ°€ "OAuth Configuration"μ "Client ID"μ— λ¶™μ—¬λ„£κΈ°
8. μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄ μ΅°νλ¥Ό μ„ν• μ•΅μ„Έμ¤ ν† ν° (Access token) λ°κΈ‰ λ°©λ²•μ€ μ κ³µμ λ¬Έμ„λ¥Ό μ°Έκ³ ν•μ„Έμ”. μλ¥Ό λ“¤μ–΄, `profile` μ¤μ½”ν”„κ°€ ν•„μ”ν•λ‹¤λ©΄ "Auth Params" ν•„λ“μ— μ•„λ κ°’ μ…λ ¥:

```json
{ "scope": "profile" }
```

</TabItem>
</Tabs>

### MCP Auth μ„¤μ •ν•κΈ° \{#set-up-mcp-auth}

MCP μ„λ²„ ν”„λ΅μ νΈμ—μ„ MCP Auth SDKλ¥Ό μ„¤μΉν•κ³  μΈκ°€ (Authorization) μ„λ²„ λ©”νƒ€λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•λ„λ΅ μ„¤μ •ν•΄μ•Ό ν•©λ‹λ‹¤.

<Tabs groupId="sdk">
<TabItem value="python" label="Python">

λ¨Όμ € `mcpauth` ν¨ν‚¤μ§€λ¥Ό μ„¤μΉν•μ„Έμ”:

```bash
pip install mcpauth
```

λλ” `uv`, `poetry` λ“± μ›ν•λ” ν¨ν‚¤μ§€ λ§¤λ‹μ €λ¥Ό μ‚¬μ©ν•μ„Έμ”.

</TabItem>
<TabItem value="node" label="Node.js">

λ¨Όμ € `mcp-auth` ν¨ν‚¤μ§€λ¥Ό μ„¤μΉν•μ„Έμ”:

```bash
npm install mcp-auth
```

</TabItem>
</Tabs>

MCP Authλ” μΈκ°€ (Authorization) μ„λ²„ λ©”νƒ€λ°μ΄ν„°κ°€ ν•„μ”ν•©λ‹λ‹¤. μ κ³µμμ— λ”°λΌ μ•„λλ¥Ό μ°Έκ³ ν•μ„Έμ”:

<Tabs groupId="provider">

<TabItem value="logto" label="Logto">

λ°κΈ‰μ (Issuer) URLμ€ Logto Consoleμ μ• ν”λ¦¬μΌ€μ΄μ… μƒμ„Έ νμ΄μ§€ "Endpoints & Credentials / Issuer endpoint" μ„Ήμ…μ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤. μ: `https://my-project.logto.app/oidc`

<SetupOidc />

</TabItem>

<TabItem value="keycloak" label="Keycloak">

λ°κΈ‰μ (Issuer) URLμ€ Keycloak Admin Consoleμ—μ„ 'mcp-realm'μ "Realm settings / Endpoints" μ„Ήμ…μ—μ„ "OpenID Endpoint Configuration" λ§ν¬λ¥Ό ν΄λ¦­ν•΄ JSON λ¬Έμ„μ `issuer` ν•„λ“μ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤. μ: `http://localhost:8080/realms/mcp-realm`

<SetupOidc />

</TabItem>

<TabItem value="oidc" label="OIDC">

μ•„λ μ½”λ“λ” μΈκ°€ (Authorization) μ„λ²„κ°€ [userinfo μ—”λ“ν¬μΈνΈ](https://openid.net/specs/openid-connect-core-1_0.html#UserInfo)λ¥Ό μ§€μ›ν•λ‹¤κ³  κ°€μ •ν•©λ‹λ‹¤. μ§€μ›ν•μ§€ μ•λ” κ²½μ°, μ κ³µμ λ¬Έμ„μ—μ„ μ—”λ“ν¬μΈνΈλ¥Ό ν™•μΈν•κ³  userinfo μ—”λ“ν¬μΈνΈ λ³€μλ¥Ό μ¬λ°”λ¥Έ URLλ΅ κµμ²΄ν•μ„Έμ”.

<SetupOidc showAlternative />

</TabItem>
<TabItem value="oauth" label="OAuth 2">

μ•μ„ μ–ΈκΈ‰ν–λ“―μ΄, OAuth 2.0μ€ μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό μ΅°νν•λ” ν‘μ¤€ λ°©λ²•μ„ μ •μν•μ§€ μ•μµλ‹λ‹¤. μ•„λ μ½”λ“λ” μ κ³µμκ°€ μ•΅μ„Έμ¤ ν† ν° (Access token)μΌλ΅ μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό μ΅°νν•  μ μλ” νΉμ • μ—”λ“ν¬μΈνΈλ¥Ό μ κ³µν•λ‹¤κ³  κ°€μ •ν•©λ‹λ‹¤. μ κ³µμ λ¬Έμ„μ—μ„ μ—”λ“ν¬μΈνΈλ¥Ό ν™•μΈν•κ³  userinfo μ—”λ“ν¬μΈνΈ λ³€μλ¥Ό μ¬λ°”λ¥Έ URLλ΅ κµμ²΄ν•μ„Έμ”.

<SetupOauth />

</TabItem>
</Tabs>

### MCP μ„λ²„ μ—…λ°μ΄νΈν•κΈ° \{#update-mcp-server}

κ±°μ λ‹¤ μ™”μµλ‹λ‹¤! μ΄μ  MCP Auth λΌμ°νΈμ™€ λ―Έλ“¤μ›¨μ–΄λ¥Ό μ μ©ν•κ³ , `whoami` λ„κµ¬κ°€ μ‹¤μ  μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄λ¥Ό λ°ν™ν•λ„λ΅ MCP μ„λ²„λ¥Ό μ—…λ°μ΄νΈν•©λ‹λ‹¤.

<Tabs groupId="sdk">
<TabItem value="python" label="Python">

```python
@mcp.tool()
def whoami() -> dict[str, Any]:
    """ν„μ¬ μ‚¬μ©μμ μ •λ³΄λ¥Ό λ°ν™ν•λ” λ„κµ¬μ…λ‹λ‹¤."""
    return (
        mcp_auth.auth_info.claims
        if mcp_auth.auth_info # Bearer μΈμ¦ (Authentication) λ―Έλ“¤μ›¨μ–΄μ—μ„ μ±„μ›μ§‘λ‹λ‹¤
        else {"error": "Not authenticated"}
    )

# ...

bearer_auth = Middleware(mcp_auth.bearer_auth_middleware(verify_access_token))
app = Starlette(
    routes=[
        # λ©”νƒ€λ°μ΄ν„° λΌμ°νΈ μ¶”κ°€ (`/.well-known/oauth-authorization-server`)
        mcp_auth.metadata_route(),
        # Bearer μΈμ¦ (Authentication) λ―Έλ“¤μ›¨μ–΄λ΅ MCP μ„λ²„ λ³΄νΈ
        Mount('/', app=mcp.sse_app(), middleware=[bearer_auth]),
    ],
)
```

</TabItem>
<TabItem value="node" label="Node.js">

```js
server.tool('whoami', ({ authInfo }) => {
  return {
    content: [
      { type: 'text', text: JSON.stringify(authInfo?.claims ?? { error: 'Not authenticated' }) },
    ],
  };
});

// ...

app.use(mcpAuth.delegatedRouter());
app.use(mcpAuth.bearerAuth(verifyToken));
```

</TabItem>
</Tabs>

## μ²΄ν¬ν¬μΈνΈ: μΈμ¦ (Authentication)κ³Ό ν•¨κ» `whoami` λ„κµ¬ μ‹¤ν–‰ν•κΈ° \{#checkpoint-run-the-whoami-tool-with-authentication}

MCP μ„λ²„λ¥Ό μ¬μ‹μ‘ν•κ³  MCP μΈμ¤ν™ν„°λ¥Ό λΈλΌμ°μ €μ—μ„ μ—½λ‹λ‹¤. "Connect" λ²„νΌμ„ ν΄λ¦­ν•λ©΄ μΈκ°€ (Authorization) μ„λ²„μ λ΅κ·ΈμΈ νμ΄μ§€λ΅ λ¦¬λ””λ ‰μ…λ©λ‹λ‹¤.

λ΅κ·ΈμΈ ν›„ MCP μΈμ¤ν™ν„°λ΅ λμ•„μ¤λ©΄, μ΄μ „ μ²΄ν¬ν¬μΈνΈμ—μ„ ν–λ κ²ƒμ²λΌ `whoami` λ„κµ¬λ¥Ό μ‹¤ν–‰ν•μ„Έμ”. μ΄λ²μ—λ” μΈκ°€ (Authorization) μ„λ²„κ°€ λ°ν™ν•λ” μ‚¬μ©μ μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄κ°€ ν‘μ‹λ©λ‹λ‹¤.

![MCP μΈμ¤ν™ν„° whoami λ„κµ¬ κ²°κ³Ό](/docs-assets/images/tutorials/whoami/result.png)

<Tabs groupId="sdk">
<TabItem value="python" label="Python">

:::info
[MCP Auth Python SDK μ €μ¥μ†](https://github.com/mcp-auth/python/blob/master/samples/server/whoami.py)μ—μ„ MCP μ„λ²„(OIDC λ²„μ „)μ μ „μ²΄ μ½”λ“λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.
:::

</TabItem>
<TabItem value="node" label="Node.js">

:::info
[MCP Auth Node.js SDK μ €μ¥μ†](https://github.com/mcp-auth/js/blob/master/packages/sample-servers/src)μ—μ„ MCP μ„λ²„(OIDC λ²„μ „)μ μ „μ²΄ μ½”λ“λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤. μ΄ λ””λ ‰ν„°λ¦¬μ—λ” TypeScript λ° JavaScript λ²„μ „μ΄ λ¨λ‘ ν¬ν•¨λμ–΄ μμµλ‹λ‹¤.
:::

</TabItem>
</Tabs>

## λ§λ¬΄λ¦¬ (Closing notes) \{#closing-notes}

π μ¶•ν•ν•©λ‹λ‹¤! νν† λ¦¬μ–Όμ„ μ„±κ³µμ μΌλ΅ μ™„λ£ν•μ…¨μµλ‹λ‹¤. μ§€κΈκΉμ§€ ν• λ‚΄μ©μ„ μ”μ•½ν•λ©΄:

- `whoami` λ„κµ¬κ°€ ν¬ν•¨λ κΈ°λ³Έ MCP μ„λ²„ μ„¤μ •
- MCP Authλ¥Ό μ‚¬μ©ν•μ—¬ MCP μ„λ²„λ¥Ό μΈκ°€ (Authorization) μ„λ²„μ™€ ν†µν•©
- MCP μΈμ¤ν™ν„°λ¥Ό μ„¤μ •ν•μ—¬ μ‚¬μ©μ μΈμ¦ (Authentication) λ° μ•„μ΄λ΄ν‹°ν‹° μ •λ³΄ μ΅°ν

μ¶”κ°€λ΅ λ‹¤μκ³Ό κ°™μ€ κ³ κΈ‰ μ£Όμ λ„ νƒκµ¬ν•΄λ³΄μ„Έμ”:

- μΈμ¦ (Authentication) λ° μΈκ°€ (Authorization)μ— [JWT (JSON Web Token)](https://auth.wiki/jwt) μ‚¬μ©
- μ ‘κ·Όν•λ” λ¦¬μ†μ¤λ¥Ό μ§€μ •ν•κΈ° μ„ν• [λ¦¬μ†μ¤ μ§€ν‘ (Resource indicator, RFC 8707)](https://auth-wiki.logto.io/resource-indicator) ν™μ©
- [μ—­ν•  κΈ°λ° μ ‘κ·Ό μ μ–΄ (RBAC)](https://auth.wiki/rbac) λλ” [μ†μ„± κΈ°λ° μ ‘κ·Ό μ μ–΄ (ABAC)](https://auth.wiki/abac) λ“± λ§μ¶¤ν• μ ‘κ·Ό μ μ–΄ κµ¬ν„

MCP Authλ¥Ό μµλ€ν• ν™μ©ν•λ ¤λ©΄ λ‹¤λ¥Έ νν† λ¦¬μ–Όκ³Ό λ¬Έμ„λ„ κΌ­ ν™•μΈν•΄λ³΄μ„Έμ”.
